<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Thomas Quinn" />

<meta name="date" content="2016-04-18" />

<title>Calculating the Proportionality Coefficient of Compositional Data with propr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Calculating the Proportionality Coefficient of Compositional Data with propr</h1>
<h4 class="author"><em>Thomas Quinn</em></h4>
<h4 class="date"><em>2016-04-18</em></h4>
</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The bioinformatic evaluation of gene co-expression often begins with correlation based analyses. However, as demonstrated thoroughly elsewhere, this approach lacks statistical validity when applied to relative data (Lovell 2015). This can include those biological data produced by microarray assays or high-throughput RNA-sequencing. As an alternative, Lovell et al propose a <em>proportionality</em> metric, <span class="math">\(\phi\)</span>, derived from compositional data analysis, a branch of math dealing specifically with relative data. A subsequent publication expounded these efforts by elaborating on another <em>proportionality</em> metric, <span class="math">\(\rho\)</span> (Erb 2016). This package introduces a programmatic framework for the calculation of differential gene co-expression using the compositional data methods presented in the referenced publications.</p>
<p><span class="math">\[\phi(A_i, A_j) = \frac{var(A_i - A_j)}{var(A_i)}\]</span></p>
<p><span class="math">\[\rho(A_i, A_j) = 1 - \frac{var(A_i - A_j)}{var(A_i) + var(A_j)}\]</span></p>
<p>In the above formulae, we let <span class="math">\(A_i\)</span> and <span class="math">\(A_j\)</span> each represent a log-ratio transformed feature vector (e.g., a vector of <span class="math">\(d\)</span> gene values measured across <span class="math">\(n\)</span> conditions). Log-ratio transformation provides a means by which to normalize data in a manner that respects the nature of relative data. In other words, log-ratio transformation yields the <em>same</em> result whether applied to absolute or relative data.</p>
<p>In this package, we make use two log-ratio transformations, the <em>centered log-ratio transformation</em> (clr) and the <em>additive log-ratio transformation</em> (alr). Although these transformations differ in definition, we sometimes will refer to them jointly using the acronym *<strong>lr</strong>. In clr-transformation, sample vectors undergo normalization based on the logarithm of the ratio between the individual elements and the geometric mean of the vector, <span class="math">\(g(\textrm{x}) = \sqrt[D]{x_i...x_D}\)</span>. In alr-transformation, sample vectors undergo normalization based on the logarithm of the rato between the individual elements and chosen reference feature.</p>
<p><span class="math">\[\textrm{clr(x)} = \left[\ln\frac{x_i}{g(\textrm{x})};...;\ln\frac{x_D}{g(\textrm{x})}\right]\]</span></p>
<p><span class="math">\[\textrm{alr(x)} = \left[\ln\frac{x_i}{x_D};...;\ln\frac{x_{D-1}}{x_D}\right]\]</span></p>
<p>The first difference between <span class="math">\(\phi\)</span> and <span class="math">\(\rho\)</span> is scale. The values of <span class="math">\(\phi\)</span> range from <span class="math">\([0, \infty)\)</span>, with lower <span class="math">\(\phi\)</span> values indicating more proportionality. The values of <span class="math">\(\rho\)</span> range from <span class="math">\([-1, 1]\)</span>, with greater <span class="math">\(|\rho|\)</span> values indicating more proportionality and negative <span class="math">\(\rho\)</span> values indicating inverse proportionality. A second difference is that <span class="math">\(\phi\)</span> lacks symmetry. However, one can force symmetry by reflecting the lower left triangle of the matrix across the diagonal with the argument <code>symmetrize = TRUE</code>. A third difference is that <span class="math">\(\rho\)</span> corrects for the individual variance of each feature in the pair, rather than for just one.</p>
</div>
<div id="calculating-proportionality" class="section level2">
<h2>Calculating proportionality</h2>
<p>We provide two principal functions for calculating proportionality. The first function, <code>phit</code>, implements the calculation of <span class="math">\(\phi\)</span> described in Lovell et al (2015). This function makes use of clr transformation exclusively. The second function, <code>perb</code>, implements the calculation of <span class="math">\(\rho\)</span> described initially in Lovell et al (2015) and expounded by Erb and Notredame (2016). This function makes use of either clr or alr transformation. For now, we will focus on the implementations using clr transformation, saving a discussion of alr transformation for later. Let us begin by building an arbitrary dataset of 4 features (e.g., genes) measured across 100 subjects. In this example dataset, feature pairs “a” and “b” will show proportional change and also feature pairs “c” and “d”.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
N &lt;-<span class="st"> </span><span class="dv">10</span>
X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a=</span>(<span class="dv">1</span>:N), <span class="dt">b=</span>(<span class="dv">1</span>:N) *<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dv">10</span>, <span class="fl">0.1</span>),
                <span class="dt">c=</span>(N:<span class="dv">1</span>), <span class="dt">d=</span>(N:<span class="dv">1</span>) *<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dv">10</span>, <span class="fl">1.0</span>))</code></pre>
<p>Let <span class="math">\(d\)</span> represent any number of features measured across <span class="math">\(n\)</span> observations across a binary or continuous event. For example, <span class="math">\(n\)</span> could represent subjects differing in case-control status, treatment status, treatment dose, or time. The <code>phit</code> and <code>perb</code> functions ultimately convert a “count matrix” with <span class="math">\(d\)</span> rows and <span class="math">\(n\)</span> columns into a proportionality matrix of <span class="math">\(d\)</span> rows and <span class="math">\(d\)</span> columns containing a <span class="math">\(\phi\)</span> or <span class="math">\(\rho\)</span> measurement for each feature pair. One can think of this matrix as analogous to a dissimilarity matrix (in the case of <span class="math">\(\phi\)</span>) or a correlation matrix (in the case of <span class="math">\(\rho\)</span>). Both functions return the proportionality matrix bundled within an object of the class <code>propr</code>. This object contains four slots:</p>
<ul>
<li><code>@counts</code> A data.frame. Stores the original “counts matrix” input.</li>
<li><code>@logratio</code> A data.frame. Stores the log-ratio transformed “counts matrix”.</li>
<li><code>@matrix</code> A matrix. Stores the proportionality matrix calculated by <code>phit</code> or <code>perb</code>.</li>
<li><code>@slot</code> pairs A data.frame. Projects the proportionality matrix pairwise.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">counts &lt;-<span class="st"> </span><span class="kw">t</span>(X)
<span class="kw">library</span>(propr)
phi &lt;-<span class="st"> </span><span class="kw">phit</span>(counts, <span class="dt">symmetrize =</span> <span class="ot">FALSE</span>)</code></pre>
<pre><code>## Calculating all phi for actual counts...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rho &lt;-<span class="st"> </span><span class="kw">perb</span>(counts, <span class="dt">ivar =</span> <span class="dv">0</span>)</code></pre>
<pre><code>## Calculating all rho for actual counts...</code></pre>
</div>
<div id="subsetting-propr-objects" class="section level2">
<h2>Subsetting propr objects</h2>
<p>We have provided methods for conveniently subsetting objects belonging to the <code>propr</code> class. By using the familiar <code>$</code> and <code>[</code> methods, we can subset the <em>entire</em> <code>propr</code> object by any of the annotations found in the <code>@pairs</code> slot. Alternatively, using the <code>subset</code> function, we can subset the <em>entire</em> <code>propr</code> object by a vector of feature indices or names. This function also provides a convenient way to re-order feature and subject vectors for downstream visualization. In the examples below, we first subset by <span class="math">\(\rho &gt; .99\)</span>. Then, separately, we subset by the feature names “a” and “b”.</p>
<pre class="sourceCode r"><code class="sourceCode r">rho99 &lt;-<span class="st"> </span>rho[rho$prop &gt;<span class="st"> </span>.<span class="dv">99</span>, ]
rho99@pairs</code></pre>
<pre><code>##   feature1 feature2      prop
## 1        a        b 0.9999326
## 6        c        d 0.9933233</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rhoab &lt;-<span class="st"> </span><span class="kw">subset</span>(rho, <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))
rhoab@matrix</code></pre>
<pre><code>##           a         b
## a 1.0000000 0.9999326
## b 0.9999326 1.0000000</code></pre>
</div>
<div id="empiric-distributions" class="section level2">
<h2>Empiric distributions</h2>
<p>The proportionality metrics generated by the <code>phit</code> and <code>perb</code> functions do not permit an easy interpretation of “How proportional is proportional enough?”. For this reason, we include an option to generate a null distribution of proportionality metrics through the randomization of feature (e.g., gene) vectors. Effectively, this yields a kernel density function that estimates how likely <code>propr</code> would measure that degree of proportionality by chance alone. In its implementation, these empiric distributions consider only the absolute value of the proportionality metrics calculated by <code>perb</code>.</p>
<p>Empiric distributions get built over <code>iter</code> iterations of proportionality analysis using <code>iterSize</code> randomized feature vectors. Setting the argument <code>iter</code> to a non-zero value will result in an empiric p-value and FDR corrected p-value for each feature pair. We emphasize here that these empiric distributions exist as a convenient guide for selecting features from ranked space and <strong>not</strong> as a means by which to form the basis of statistical hypothesis testing. The example below generates empiric probabilities for a “counts matrix” of 1000 random features measured across 22 subjects. As expected, we see here that while tens of thousands of feature pairs have proportionality scores rarer than expected by chance (<span class="math">\(p &lt; .01\)</span>), none of these pairs survive a correction for multiple testing.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
randomNum &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">1000</span>, <span class="dt">size =</span> <span class="dv">2000</span> *<span class="st"> </span><span class="dv">22</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
counts &lt;-<span class="st"> </span><span class="kw">matrix</span>(randomNum, <span class="dt">nrow =</span> <span class="dv">2000</span>, <span class="dt">ncol =</span> <span class="dv">22</span>)
prop &lt;-<span class="st"> </span><span class="kw">phit</span>(counts, <span class="dt">symmetrize =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">50</span>, <span class="dt">iterSize =</span> <span class="dv">500</span>)</code></pre>
<pre><code>## Calculating all phi for actual counts...
## Calculating simulated phi for iter 1...
## Calculating simulated phi for iter 2...
## Calculating simulated phi for iter 3...
## Calculating simulated phi for iter 4...
## Calculating simulated phi for iter 5...
## Calculating simulated phi for iter 6...
## Calculating simulated phi for iter 7...
## Calculating simulated phi for iter 8...
## Calculating simulated phi for iter 9...
## Calculating simulated phi for iter 10...
## Calculating simulated phi for iter 11...
## Calculating simulated phi for iter 12...
## Calculating simulated phi for iter 13...
## Calculating simulated phi for iter 14...
## Calculating simulated phi for iter 15...
## Calculating simulated phi for iter 16...
## Calculating simulated phi for iter 17...
## Calculating simulated phi for iter 18...
## Calculating simulated phi for iter 19...
## Calculating simulated phi for iter 20...
## Calculating simulated phi for iter 21...
## Calculating simulated phi for iter 22...
## Calculating simulated phi for iter 23...
## Calculating simulated phi for iter 24...
## Calculating simulated phi for iter 25...
## Calculating simulated phi for iter 26...
## Calculating simulated phi for iter 27...
## Calculating simulated phi for iter 28...
## Calculating simulated phi for iter 29...
## Calculating simulated phi for iter 30...
## Calculating simulated phi for iter 31...
## Calculating simulated phi for iter 32...
## Calculating simulated phi for iter 33...
## Calculating simulated phi for iter 34...
## Calculating simulated phi for iter 35...
## Calculating simulated phi for iter 36...
## Calculating simulated phi for iter 37...
## Calculating simulated phi for iter 38...
## Calculating simulated phi for iter 39...
## Calculating simulated phi for iter 40...
## Calculating simulated phi for iter 41...
## Calculating simulated phi for iter 42...
## Calculating simulated phi for iter 43...
## Calculating simulated phi for iter 44...
## Calculating simulated phi for iter 45...
## Calculating simulated phi for iter 46...
## Calculating simulated phi for iter 47...
## Calculating simulated phi for iter 48...
## Calculating simulated phi for iter 49...
## Calculating simulated phi for iter 50...
## Fitting phi to distribution...
## Using fit to convert phi into pval...
## Correcting for multiple testing...
## Building results...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(prop$pval &lt;<span class="st"> </span>.<span class="dv">01</span>) <span class="co"># 20,422 pairs show rare proportionality</span></code></pre>
<pre><code>## [1] 20422</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(prop$fdr &lt;<span class="st"> </span>.<span class="dv">01</span>) <span class="co"># ...but none survive FDR correction</span></code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="visualizing-pairs" class="section level2">
<h2>Visualizing pairs</h2>
<p>Each feature (e.g., gene) belonging to a highly proportional data pair should show approximately linearly correlated log-ratio transformed expression with one another across all subjects. The method <code>plot</code> provides a means by which to visually inspect whether this holds true. This function will plot <strong>all</strong> pairs in the <code>@pairs</code> slot. Therefore, we strongly recommend the user first subset the <code>propr</code> object before plotting. “Noisy” correlation between some feature pairs could suggest that the proportionality cutoff is too lenient. We include this plot as a handy “sanity check” when working with high-dimensional datasets.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rho[rho$prop &gt;<span class="st"> </span>.<span class="dv">99</span>, ])</code></pre>
<pre><code>## Shaping pair 1 ...Shaping pair 2 ...</code></pre>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
<div id="computational-burden" class="section level2">
<h2>Computational burden</h2>
<p>Calculating proportionality metrics, whether or not in conjunction with empiric distributions, necessarily uses a lot of RAM when applied to real biological data. Both microarray technology and high-throughput genomic sequencing have the ability to measure tens of thousands of features for each subject. The calculation of proportionality requires manipulating a matrix sized <span class="math">\(d^2\)</span>. Below, we provide a small table that estimates the approximate amount of peak RAM needed based on the number of feature.</p>
<table>
<thead>
<tr class="header">
<th align="right">Features</th>
<th align="right">Peak RAM (Mb)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1000</td>
<td align="right">101</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="right">283</td>
</tr>
<tr class="odd">
<td align="right">4000</td>
<td align="right">926</td>
</tr>
<tr class="even">
<td align="right">8000</td>
<td align="right">3,322</td>
</tr>
<tr class="odd">
<td align="right">16000</td>
<td align="right">12,554</td>
</tr>
<tr class="even">
<td align="right">24000</td>
<td align="right">27,706</td>
</tr>
<tr class="odd">
<td align="right">32000</td>
<td align="right">48,779</td>
</tr>
<tr class="even">
<td align="right">64000</td>
<td align="right">192,276</td>
</tr>
<tr class="odd">
<td align="right">100000</td>
<td align="right">466,940</td>
</tr>
</tbody>
</table>
</div>
<div id="additive-log-ratio" class="section level2">
<h2>Additive log-ratio</h2>
<p>We recognize that this package utilizes concepts largely unintuitive to many. Since log-ratio transformations of relative data comprise a major portion of proportionality analysis, we decided to dedicate some extra space to this topic specifically. In this section, we will introduce the <strong>additive log-ratio</strong> (alr) and its intrinsic advantages. First, however, we will begin by making some count data for 5 features (e.g., genes) labelled “a”, “b”, “c”, “d”, and “e”, as measured across 100 subjects.</p>
<pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="dv">100</span>
a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">5</span>, <span class="dt">to =</span> <span class="dv">15</span>, <span class="dt">length.out =</span> N)
b &lt;-<span class="st"> </span>a *<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="fl">0.1</span>)
c &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean =</span> <span class="dv">10</span>)
d &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean =</span> <span class="dv">10</span>)
e &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">10</span>, N)
X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(a, b, c, d, e)</code></pre>
<p>Let us assume that these data <code>X</code> represent absolute abundance counts (i.e., not relative data). The following figures compare the absolute count data scatterplots with the corresponding relative count data scatterplots. We see quickly how these relative data yields <em>spurious correlation</em>. Although genes “c” and “d” do not correlate with one another absolutely, their relative quantities do.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(X)
<span class="kw">pairs</span>(X /<span class="st"> </span><span class="kw">rowSums</span>(X))</code></pre>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<p>Likewise, if we did calculate correlation directly, we would discover that the correlation coefficients differ for absolute and relative data. Here, we see numerically how relative data can yield spurious correlation.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(X)</code></pre>
<pre><code>## Warning in cor(X): the standard deviation is zero</code></pre>
<pre><code>##             a           b           c           d  e
## a  1.00000000  0.94927077 -0.08067413 -0.12779121 NA
## b  0.94927077  1.00000000 -0.09769074 -0.14621526 NA
## c -0.08067413 -0.09769074  1.00000000  0.07408882 NA
## d -0.12779121 -0.14621526  0.07408882  1.00000000 NA
## e          NA          NA          NA          NA  1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(X /<span class="st"> </span><span class="kw">rowSums</span>(X))</code></pre>
<pre><code>##            a          b          c          d          e
## a  1.0000000  0.8899662 -0.8330170 -0.8380507 -0.8780069
## b  0.8899662  1.0000000 -0.8398135 -0.8517895 -0.8757564
## c -0.8330170 -0.8398135  1.0000000  0.5534690  0.7157800
## d -0.8380507 -0.8517895  0.5534690  1.0000000  0.6995905
## e -0.8780069 -0.8757564  0.7157800  0.6995905  1.0000000</code></pre>
<p>By calculating the <strong>variance of the log-ratios</strong> (vlr), we arrive at a single measure of covariation that does not change with respect to the use of absolute or relative data. This vlr constitutes the numerator portion of the <span class="math">\(\phi\)</span> metric and a portion of the <span class="math">\(\rho\)</span> metric also.</p>
<pre class="sourceCode r"><code class="sourceCode r">propr:::<span class="kw">proprVLR</span>(X)</code></pre>
<pre><code>##            a          b          c          d          e
## a 0.00000000 0.00975737 0.11376810 0.12071923 0.09796050
## b 0.00975737 0.00000000 0.13365068 0.14165890 0.11599137
## c 0.11376810 0.13365068 0.00000000 0.02308318 0.01153949
## d 0.12071923 0.14165890 0.02308318 0.00000000 0.01344981
## e 0.09796050 0.11599137 0.01153949 0.01344981 0.00000000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">propr:::<span class="kw">proprVLR</span>(X /<span class="st"> </span><span class="kw">rowSums</span>(X))</code></pre>
<pre><code>##            a          b          c          d          e
## a 0.00000000 0.00975737 0.11376810 0.12071923 0.09796050
## b 0.00975737 0.00000000 0.13365068 0.14165890 0.11599137
## c 0.11376810 0.13365068 0.00000000 0.02308318 0.01153949
## d 0.12071923 0.14165890 0.02308318 0.00000000 0.01344981
## e 0.09796050 0.11599137 0.01153949 0.01344981 0.00000000</code></pre>
<p>In the same way, transforming a counts matrix using the <strong>centered log-ratio</strong> (clr) makes the data <em>subcompositionally coherent</em> (i.e., equivalent for absolute and relative data types). When calculating proportionality, we use (by default) the variance about the clr-transformed data to normalize the variance of the log-ratios (vlr) by the variance of its individual constituents. In this way, the use of clr-transformed data shifts the vlr-matrix onto a “standardized” scale that compares across all feature pairs. However, it does not guard against the possibility of <em>spurious proportionality</em>. In the next figures, we compare log-ratio transformed absolute count data scatterplots with the corresponding log-transformed relative count data scatterplots. While equivalent, we see a relationship between “c” and “d” that should not exist, and one that is ultimately reflected (at least partially) in the results of <code>phit</code> and <code>perb</code> alike.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(propr:::<span class="kw">proprCLR</span>(X))
<span class="kw">pairs</span>(propr:::<span class="kw">proprCLR</span>(X /<span class="st"> </span><span class="kw">rowSums</span>(X)))</code></pre>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<pre class="sourceCode r"><code class="sourceCode r">phi &lt;-<span class="st"> </span><span class="kw">phit</span>(<span class="kw">t</span>(X))</code></pre>
<pre><code>## Calculating all phi for actual counts...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">phi@matrix</code></pre>
<pre><code>##           a         b         c         d         e
## a 0.0000000 0.2624509 3.0601008 3.2470701 2.6349124
## b 0.2624509 0.0000000 2.7304336 2.8940385 2.3696604
## c 3.0601008 2.7304336 0.0000000 0.9179974 0.4589152
## d 3.2470701 2.8940385 0.9179974 0.0000000 0.4716073
## e 2.6349124 2.3696604 0.4589152 0.4716073 0.0000000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rho &lt;-<span class="st"> </span><span class="kw">perb</span>(<span class="kw">t</span>(X))</code></pre>
<pre><code>## Calculating all rho for actual counts...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rho@matrix</code></pre>
<pre><code>##            a          b          c          d          e
## a  1.0000000  0.8867087 -0.8254582 -0.8375159 -0.8241165
## b  0.8867087  1.0000000 -0.8038071 -0.8286213 -0.7715744
## c -0.8254582 -0.8038071  1.0000000  0.5698591  0.7230759
## d -0.8375159 -0.8286213  0.5698591  1.0000000  0.7014085
## e -0.8241165 -0.7715744  0.7230759  0.7014085  1.0000000</code></pre>
<p>With the <strong>additive log-ratio</strong> (alr), instead of using the geometric mean of the composition as the denominator, we select the value of one its components to use as a <em>reference</em>. If we select this reference as a feature (e.g., gene) with an <em>a priori</em> known fixed absolute count across all subjects, we can actually “back-calculate” absolute data from relative data. When crafting the data <code>X</code>, we included “e” as a fixed constant. Let us perform alr-transformation of the relative data with “e” as the reference. We will see in this figure that the spurious correlation between “c” and “d” disappears. Again, this gets reflected in the results of <code>perb</code>, when we select “e” as the reference.</p>
<pre class="sourceCode r"><code class="sourceCode r">X.alr &lt;-<span class="st"> </span>propr:::<span class="kw">proprALR</span>(X /<span class="st"> </span><span class="kw">rowSums</span>(X), <span class="dt">ivar =</span> <span class="dv">5</span>)
<span class="kw">pairs</span>(X.alr)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<pre class="sourceCode r"><code class="sourceCode r">rho &lt;-<span class="st"> </span><span class="kw">perb</span>(<span class="kw">t</span>(X), <span class="dt">ivar =</span> <span class="dv">5</span>)</code></pre>
<pre><code>## Calculating all rho for actual counts...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rho@matrix</code></pre>
<pre><code>##             a           b           c           d
## a  1.00000000  0.95439455 -0.03897825 -0.08355535
## b  0.95439455  1.00000000 -0.04798701 -0.09438827
## c -0.03897825 -0.04798701  1.00000000  0.07627740
## d -0.08355535 -0.09438827  0.07627740  1.00000000</code></pre>
<p>Now, let us assume these same data actually measure relative counts. In other words, <code>X</code> is already relative and we do not know the real quantities which correspond to <code>X</code> absolutely. Well, if we knew that “a” represented a known fixed quantity, we could use alr-transformation again to “back-calculate” the absolute abundances. We will see that “c”, “d”, and “e” actually do have proportional expression under these conditions. Although the measured quantity of “c”, “d”, and “e” do not change, the measured quantity of the known fixed feature did change. Whenever “a” increased while “c”, “d”, and “e” remained the same, the latter three features actually had decreased. Since they all decreased together, they acted as a highly proportional module. Again, this gets reflected in the results of <code>perb</code>, when we select “a” as the reference.</p>
<pre class="sourceCode r"><code class="sourceCode r">X.alr &lt;-<span class="st"> </span>propr:::<span class="kw">proprALR</span>(X /<span class="st"> </span><span class="kw">rowSums</span>(X), <span class="dt">ivar =</span> <span class="dv">1</span>)
<span class="kw">pairs</span>(X.alr)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OgA6OpA6ZmY6ZrY6kNtmAABmADpmAGZmOjpmZgBmZjpmkJBmtv+QOgCQOjqQ29uQ2/+2ZgC2Zjq2/7a2///bkDrb////tmb/25D//7b//9v///9Jeeb/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQJElEQVR4nO2dDZ/cphGHJ02c1O05SRs7vW1zvhe+/3fsaiVgmBcGJKTV2fP373y7KxjBwzAgkG4huKqCexfg7HJAhhyQIQdkyAEZckCGHJAhB2TIARlyQIYckCEHZMgBGXJAhhyQIQdkyAEZckCGHJAhB2TIARlyQIYckCEHZMgBGXJAhhyQIQdkyAEZckCGHJAhB2TIARk6CNAzwOfbiyeAnxo+X2P6auSh7aw9OgbQ66+PL7/8dX3x8vHr25fP5udrTF+NfHiQD623fhSgqYR/PgbWxtrna0yHtz//Pdz6UYCerw5+mZrw8scH7Oza52tMXzEQEAOsHw/ox69LdaqfrzF99RcV0GrrRwC6XANkcvapmKga2udrTF8DMUBhYqP1WQcH6dwhqp+vMR0YhAHWjx3mX3/7a2rnh4bP15hWhvlt1n2iaMkBGXJAhhyQIQdkyAEZckCGHJChIwEB+hFebDWN7En/b7J8jBxQw7kckHGukwB6uS0QzVdwLZaP0XkATQuwz3/7ywFpgG5kXn/7nwNC/2PN62ivv/+yJyCwtTr1vsbDFIOm9bNrL9sTUFeK7CxzYedf6GVpD1JigNLJYmWpcSgs56PoRKt0NKCl9PlV2fFQ8hnQ7QcdLnomNh45wPIvFOllR9o3SPcDikXMBY4fSoCS+0CZWgJUGitdiXjU+Gquz0kAkXYGVAFWhyUtAKQ+cnud3aM0jnwz9845V/LBvaq5PqcEKES3mOu7eFOQAUFKtlQ0/seMQ/KiDD5yK7rcoudbsh8eR1RzfU4GKNUWlR+HpTJrrnJAgHAwyqkXV8PW8gk4oGWn/uXj1wHVXJ9TiEEpnDTEIORCOSPqcyg1OlzEuQy5LNkSnU8XpAMeTnLUtQAtfaoc0mRAaPhK7sSMZw/ad6LYlYICgh5AcVTKKKoehM4IgfnWTdeL1fPFIFLW5EdSL2DJQwbEB+4l/pRehAHdexR7+yK2BQMUqwK5pwQdEMaTwhXvS4GDT5+iudSAaq7P2QEIeG1iRUhW5m6ZD53Z5GGeUkq9ckQ11+fsASSLjsQYB603Ty4mxOzfDyCNEANUr3U9SHNCZ4hBFwC6eEDCRPwtV0XyoIIJqrJgXAUPgPvrpmquz3kF9Pfp9MSPiAeRwCswwsmtdBVALLyvIiNUYnXOty83Nhdyp6QISIwrfB6U6sm8STJeww7Dqrk+5xXQNDN9/VR2Mg5IrwVoHsT5gHSpoQ96gRlfW831Od++zGQu8FlJkUtKq5CdKpTJM7jkCgDJEYF7UDlLLwLX/T1oBvRUARRoQ5OZIB3FuCtgJ1K6GEGF0I6o5vqcyYPKKC0AwnUl12UMkByxwuIQEiBsPrqZDOiIjcPuGCQOTcUVQZEcQUxhB1ccp0auhewKsSkV+ICNQzaKXf+vjmKIRR7xtRiUU5d1DJCOodQQXRA5D/ZVWs1DNg7LLvavqSBkpqjMpFM7FwFJuFhFEEkMYsbTgYgD+yUHdMzGITrfNQZdZ9I/flVT5Nd5IShFHmkehH5ipjIZARTTJyJ4zOPVPOnG4fwqTv5DSJcBwjwo4H6E469sPHth9CAUu+8+zDekgOJVmsuksCIBwu/L2EuDtGQbkSHGk862Jp1fITeIteZdjLzPI16InYqlRh0qjYNiF2vX8YBwe+YWNwDhLlQBxHpaGe3XXHEcDqgoZe5qIiA1LQfEk+b8ggedcuMw/Za8SQzStbTyKEaTim9Pu3EYf8s5TUA149ZIRY6ddOMw/r4/oGM2Dm2tTr2v8XDMxuF3ou8Y0HPTo/QOyJADMvQdA2qTAzLkgAw5IEMOyFADoJefH5/5nQnfi2xAb38+Tle9LVe+36JsQNdL3pd/Cle+u14u7Wp8MKDw38dpl2SCRHIuK1eQ19/1ZcG+a38tOaTdwGbjM55dAb19mc5B93QioLSeGaor70MAQd5KbDQOcAAgPSfgfZvYtLLtEYDUvVJ90eiQLjYrxyB0ToC8cVx+TG0PAIROQreeRXuHxSA9Z2KEC5/eDwZEtp8t4yWe+wFK7VmUJv7rOY8JCJ/BNg4lo7Y6WcWSpWyRQIgcyqJjTD3nqQAqG8AGRNPvC4htkaBzxu5UFmU0oNiT1U5DjPMy7QpI2yKJkSZAMb4kRuNikACoapzfqLVrDNK2SPIdS2QADvin/TwGIHRDAktBAeWeGDPsGoOULZI0dSZtlQfhkTGIdRXVOIaTMtxnFFtaVh4tSMff5kFCKKnMSIXyHAqojDRLQMAlip1eB3QB/rdDFUA09kjJoUwcUAHXV3NQTupB8ZqsBmi+uKOEZECKf8rGeVHOAKgc67ErafV5mlbfXj5UHn2JxonFXkBySO/TAEB8XkZHnPI8y9NlT8SFOCDindW4M/+mriwb79KmGMQLlVY9KhPF109s6YSVRAJkrqVo7kONd2lATnLXc+oZ2wGpdIIESPMeZrxL4wDRHqb2iFZAZf8yPUh3H2q8SyNyUteWhg4eg14+6A8usPlnfd4ArBCn8SAAXrhEqDqKLQ/AKCVhFmsuKaWWCrtKG4J0bFZhbaFen2UeRDqaNnlOp6oM8zWSa6vZnlPZOFwmqnE9WugP9Zk0vfmk4kHLWfQYxBunv5qK7JzaxiEGxJu7DsgsCV8+oSZkQIFFn9bTNxVLlLpxGPKUJzUdasJtgIgHUf+RAcne03b6pmLJohuHRcFDWpUmLU7KusWDOJ2geZC2dLgrIHXjML3A/r14eW1UbigJdaB6cpPP/edBy3Uz8p+wDRCKbXbylLbNeJeac0oxKL1CZUMRdROgtNjUBEjuhj2n3zNnCSMF1a0ritEd7eT17tV2+oE5eXcnLQhhhAcZflEar7ha4+k35NQ3Dsm7TGjEor3Ra3gMajbepYaJovJsVQWQkGINoGouAsg4w84TRfQLl8rU6tT7Gh8MqOPZqm9RDWjbn636FrXe974TNQJqezLmW5QDMuSADHkMMuSADDkgQw7IkAMy5IAMbbiK2/N6clfjfdUckDMvNoC6ilhZLhY23jtXR+pLZSAsprU/RbkJEMSFMcgrZFCksM+TFlf3AkRuwrqp4ynKLYASj+wERU3bAMldrOH0TanlLqZthhrn6RMGFApPgJSi4TzxlrR9ulgsEU2hPEVpnKdPHFC++Y5X2fSgnQAFwXhQN0ON8/QJxaDFhyOerpsXdu1ikO8IXKttOZOjzG9iYZaPe3rBLh5kjfa7/w2z3DwpAs1H6vc7lWb28qCCy508KJFAN3RAfNPXyMODNOBb3+4MqGiqGI9CZyMP9SBgZSIJDvpDk4hJarCleGYdynsbgxmDajfF0tQ88pBGOOgPTeapDykMGv3F+kCcE1C/qxSrHRBzH27voD80Gac/yI+K/qLUYZkD5CxNE8VmQGZRwmHfUFdGZvQy8N1yDAhiYC8qMQSQ0FiivYO+oa7sIrm5hE6D6xCCVAkd0OsngJ+aALFOP6SaG3LyW4DzEbWRWRcQGhm/mVv7H/2AQr4Go8D6qrlOCyCxx/NOk+sgxysd0PxtFM/0znPJOG0t+bq5v5obcgIeQ1O7Bd2DlOS0JOjNy4fbNeWTDYjfjXx/QKy6sdmoQ+OSkqBlAHqeyTTEILo2BvePQbFgCU7y64oHBbkSOqDbo5tNgFi/JUU8PAYtL4C0XekaRWogUkqywoM0u9x4l8YAEvcVzEauTJ67Y1Dl1Mx4l0Z5EJktzh/T1JyhVhL85vbNgPP3XSkp5NmGarxLA2MQKSAHJIxgWkk650EWn/vEoDSBATqACH5eBmeptLo7TQvI9Zl05cSCvXDcvlhZOjqMjAJkFtx0IGrvoH0x5Wojs6rUgbfzGEBB7kbkw4P2xeTAkr2HDzT6CtlAD7JSTzpkXyxdmQKbCYF0LSakUEuyAZBW2OLgQfti5blzERRAuB8YcXQNoHSZY6Tu05icQvORxoS0Wq0186AYZKfOOvK7faSwIs2kg/rk0iZAgS9rVwrbo2GAQjsg+aSbAVVT1x2s8TydOW2tTr2v8XDMvth71iH7Yu9Zh+yLvWcdsi/2ruVfwDZM3zEg//osQw7IkAMaogZA/uVHdfmXHxnyLz+yZHz50VLCtC4v266dRwJUKS6wlZW+a/8+NeSsf/lRNJKeQACUouU8sKy0twJaaJ4IkJozA4J8vzS6I6GpDiCu1aiA5oS0izUUdq2ac0pffoQKi96G9LLlPF2AUEw5HSAtJxTNmkq/x6MIgLZO3iEgdJNHByDZJcTkOWWze3ak2JCz/jfMMqBUzcWhWgG1jmLYP88Ug2p/wwxFI+Q1HTEIkKxilfewnQdQ7cuPln5Fp2qC7ZpLNHQxHH5A2pU0dIQH/SKMYijwFG+ahnnCtAaobAKW4s4xSP3yowIPqib+qZwH15qmYIAglHzOBKiSM4cg3FHS7+p5aKdsBSSkOC8g0rblvLFeB+gBJMwGdOM3jy+/UOCugOKFBgo9LTEI0xkK6DInrHwnRZc25Sz9BrtCFyCOk3WxMmnN+PNtaY9+KcWhgGi8ARyplwTMNogm8K0eFUApJZosacYv82jy+qlwoft4UHIX6gwhxFgkn4cFLiFFfima1wAt39kBZH3mfIBqQRo5nQ1ImAJxg/nl9PDdrGIR/X4xCK8BxW6XLu/l89DbhWuAEEpy45XqQeLuwv1GsfllEYninLoRUC0G4aS6wTIG0RGeG+/SiJzUIVKIkc8juQ8tCfCkukuSUexGiDz7cp9RLBRdAFW63uBKnQVAzLJScGkeVPa0e3lQDNHEK6oNThLLJcmhTPaf2hzitn5FtpXvDIg2NTrKztPkEnEEKBZkWwFphV2nxpzTzpiQc/6hPaEGSPOf+kzp1IDizIIOnykGBVLtahdTHYgBKlPS1CcCdL06fig8SGx+yYeEOuDuWCsJnSvxcp4I0HXM/OE/chdLr0vnUQHp/mN4EC/mqQDFL7YscwKuNK8QB1SvMgOk+hpLfn9ASs7oKKyD8W7BINZLYrhPOCEgeVdDHMQSC5K6XmcdkFnwUwCScmJA5cqQNMx3uESB3S74yQCRoiOfiYtA8Vd5nl5A4b0A0raeba1Ova/xwYBqT8aA8Kv8bEuxQH2xzXh/SaqqPRnjgEL9yRgHNKnyZIwDasvtgLTnGhxQlAMy5F+f5VLkgAw5IEMOyJADMuSADDkgQ6sBLTcJzH/Dr+lAp+HwpBhmB3bVWkCvvz7O1/dPP8XrfeNAr+GXj19lw/TAvloLaCpl2it7emg40GuY5lUP7Ku1gKZrj8vSjMVamnqg1/Dlj/LPt6oH9tUAQFffbznQa/jy49dEunpgX60BdJn+tGrqSS8/FxjUA72GJwZi36UH9tXmIE2XYtUDvYZxX60e2FfbhvlrkLnd8fbQcqDT8DSaPzQd2FU+UTTkgAw5IEMOyJADMuSADDkgQw7IkAMy5IAMOSBDDsiQAzLkgAw5IEMOyJADMuSADDkgQw7IkAMy5IAMOSBDDsiQAzLkgAw5IEMOyJADMuSADDkgQw7IkAMy5IAM/R+byFk4YKZLJAAAAABJRU5ErkJggg==" /></p>
<pre class="sourceCode r"><code class="sourceCode r">rho &lt;-<span class="st"> </span><span class="kw">perb</span>(<span class="kw">t</span>(X), <span class="dt">ivar =</span> <span class="dv">1</span>)</code></pre>
<pre><code>## Calculating all rho for actual counts...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rho@matrix</code></pre>
<pre><code>##             b           c           d           e
## b  1.00000000 -0.08196859 -0.08570352 -0.07680716
## c -0.08196859  1.00000000  0.90155896  0.94549867
## d -0.08570352  0.90155896  1.00000000  0.93849541
## e -0.07680716  0.94549867  0.93849541  1.00000000</code></pre>
</div>
<div id="experimental-design" class="section level2">
<h2>Experimental design</h2>
<p>[spike-in discussion here]</p>
<p>[data-driven nature here]</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
